<!DOCTYPE refentry PUBLIC "-//OASIS//DTD DocBook V4.4//EN" 
    "http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd" [
 <!ENTITY copyright SYSTEM "copyright.xml">
 <!ENTITY % idcommon SYSTEM "common/common.ent">
     %idcommon;
]>
<refentry id="ref-record_transform">
 <refentryinfo>
  <productname>Metaproxy</productname>
  <info><orgname>Index Data</orgname></info>
 </refentryinfo>

 <refmeta>
  <refentrytitle>record_transform</refentrytitle>
  <manvolnum>3mp</manvolnum>
  <refmiscinfo class="manual">Metaproxy Module</refmiscinfo>
 </refmeta>
 
 <refnamediv>
  <refname>record_transform</refname>
  <refpurpose>Metaproxy Module that performs Z39.50 presentResponse record transformations</refpurpose>
 </refnamediv>

 <refsect1><title>DESCRIPTION</title>
  <para>
   This filter acts only on Z3950 present requests, and let all
   other types of packages and requests pass untouched. It's use is
   twofold: blocking Z3950 present requests, which the backend
   server does not understand and can not honor, and transforming
   the present syntax and elementset name according to the rules
   specified, to fetch only existing record formats, and transform
   them on the fly to requested record syntaxes.
  </para> 
  <para>
   The allowed record present syntax and 
   element name are described in multiple
   <literal>&lt;retrieval&gt;</literal> elements inside the 
   <literal>&lt;retrievalinfo&gt;</literal>
   element. The <literal>syntax</literal> attribute is mandatory, but
   the <literal>name</literal> attribute
   may be omitted, in which case any 
   element name is accepted. An additional
   <literal>identifier</literal> attribute can be added to explicitly
   describe the Z3950 identifier string.
  </para>
  <para>
    The <literal>&lt;retrieval&gt;</literal> element and the content
    is described in the 
    <ulink url="&url.yaz.retrieval;">Retrieval Facility</ulink> section
    of the YAZ manual.
  </para>
 </refsect1>
 
 <refsect1><title>SCHEMA</title>
   <literallayout><xi:include
		     xi:href="../xml/schema/filter_record_transform.rnc"
		     xi:parse="text"  
		     xmlns:xi="http://www.w3.org/2001/XInclude" />
   </literallayout>
 </refsect1>
 
 <refsect1><title>EXAMPLES</title>
  <para>
   A typical configuration looks like this:
   <screen><![CDATA[
    <filter type="record_transform">
      <retrievalinfo  xmlns="http://indexdata.com/yaz" version="1.0">
        <retrieval syntax="xml" name="dc"
                   identifier="info:srw/schema/1/dc-v1.1">
          <backend syntax="usmarc" name="F">
            <marc inputformat="marc" outputformat="marcxml"
                  inputcharset="marc-8"/>
            <xslt stylesheet="../xml/xslt/MARC21slim2DC.xsl"/>
          </backend>
        </retrieval>
        <retrieval syntax="opac"/>
        <retrieval syntax="xml" name="opac">
          <backend syntax="opac" name="F">
          <marc inputformat="marc" outputformat="marcxml"
                inputcharset="marc-8"/>
          </backend>
        </retrieval>
        <retrieval syntax="usmarc">
          <backend syntax="usmarc" name="F">
          </backend>
        </retrieval>
      </retrievalinfo>
    </filter>
]]>
   </screen>
  </para>
 </refsect1> 
 
 <refsect1><title>SEE ALSO</title>
  <para>
   <citerefentry>
    <refentrytitle>metaproxy</refentrytitle>
    <manvolnum>1</manvolnum>
   </citerefentry>
  </para>
 </refsect1>
 
 &copyright;
</refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: nxml
nxml-child-indent: 1
End:
-->
